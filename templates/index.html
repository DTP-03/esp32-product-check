<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Product Status</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; padding: 40px; }
        img { width: 400px; height: auto; border: 2px solid #000; margin-top: 20px; }
        .status { font-size: 24px; font-weight: bold; margin-top: 20px; }
        button { padding: 10px 20px; font-size: 16px; margin: 10px; }
    </style>
</head>
<body>
    <h1>Product Status Monitor</h1>

    <div class="status" id="status">Status: WAITING</div>
    <img id="productImage" src="/static/latest1.jpg?ts={{ time }}" alt="Latest Product Image">

    <div>
        <button onclick="setMode('auto')">Auto Mode</button>
        <button onclick="setMode('manual')">Manual Mode</button>
    </div>

    <script>
        function updateStatus() {
            fetch('/status')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('status').textContent = "Status: " + data.status;

                    // Cập nhật ảnh nếu có timestamp mới
                    const img = document.getElementById('productImage');
                    img.src = '/static/' + data.image + '?ts=' + new Date().getTime();
                });
        }

        function setMode(mode) {
            fetch('/set-mode', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ mode: mode })
            })
            .then(response => response.json())
            .then(data => {
                alert('Mode set to: ' + data.mode);
            });
        }

        // Cập nhật liên tục mỗi 2 giây
        setInterval(updateStatus, 2000);
    </script>
</body>
</html>
